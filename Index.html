<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Las Huellitas de mi Vida üêæ</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Fredoka -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* Estilos personalizados y de componentes */
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Fredoka', sans-serif;
            background-image: linear-gradient(to bottom, #2b1634, #1f143a);
            color: #F0F0F0;
            overflow-x: hidden;
        }

        h1, h2, h3 {
            font-weight: 700;
        }

        /* Efecto de borde con gradiente en hover para las tarjetas */
        .gradient-border-card {
            position: relative;
            background-color: rgba(255, 255, 255, 0.05);
            border: 2px solid transparent;
            transition: all 0.3s ease-in-out;
        }

        .gradient-border-card:hover {
            border-image: linear-gradient(to right, #00FFFF, #FF00FF) 1;
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        /* Estilo para botones de m√©todo de pago */
        .payment-method-btn {
            background-color: rgba(255, 255, 255, 0.05);
            border: 2px solid #00FFFF;
            transition: all 0.3s ease-in-out;
        }
        .payment-method-btn.selected {
            background-color: #4A00E0;
            border-color: #FF00FF;
            box-shadow: 0 0 15px rgba(255, 0, 255, 0.5);
        }

        /* Bot√≥n principal con gradiente y efecto de brillo */
        .main-btn {
            background-image: linear-gradient(to right, #4A00E0, #8E2DE2);
            box-shadow: 0 4px 15px rgba(142, 45, 226, 0.4);
            transition: all 0.3s ease-in-out;
        }

        .main-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(142, 45, 226, 0.6);
        }

        /* Estilo para los campos de texto del formulario */
        .form-input {
            background-color: transparent;
            border: none;
            border-bottom: 2px solid #00FFFF;
            color: #F0F0F0;
            transition: border-color 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-bottom-color: #FF00FF;
            box-shadow: none;
            ring: 0;
        }

        /* Animaci√≥n de entrada para las secciones */
        .section-fade-in {
            animation: fadeIn 0.8s ease-in-out forwards;
        }
        
        .content-fade-in {
             animation: contentFadeIn 0.5s ease-in-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes contentFadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Estilo para las huellas decorativas del fondo */
        .background-paws {
            position: fixed; /* Cambiado a fixed para efecto parallax */
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            overflow: hidden;
            z-index: -1;
        }
        
        .background-paws img {
            position: absolute;
            opacity: 0.15;
            filter: brightness(0.8);
            pointer-events: none;
        }
    </style>
</head>
<body class="min-h-screen w-full relative">

    <!-- Huellas decorativas de fondo -->
    <div class="background-paws">
        <img src="https://i.ibb.co/Z1J9YXq9/huellas-1.png" class="w-24 -top-5 left-10 rotate-12">
        <img src="https://i.ibb.co/mFSBSN3X/huellas-2.png" class="w-32 top-1/4 -right-10 -rotate-45">
        <img src="https://i.ibb.co/vx7Wb795/huellas.png" class="w-16 top-1/2 left-1/4 rotate-6">
        <img src="https://i.ibb.co/ttbd6wP/huellas-4.png" class="w-20 bottom-10 right-1/3 -rotate-12">
        <img src="https://i.ibb.co/MDZYf540/huellas-6.png" class="w-28 bottom-24 -left-8 rotate-45">
        <img src="https://i.ibb.co/Z1J9YXq9/huellas-1.png" class="w-12 top-20 right-10">
        <img src="https://i.ibb.co/mFSBSN3X/huellas-2.png" class="w-40 bottom-0 left-1/2 -translate-x-1/2 rotate-180">
    </div>

    <!-- Header -->
    <header class="fixed top-0 left-0 w-full bg-black/10 backdrop-blur-md z-50 py-4 text-center">
        <h1 class="text-2xl font-bold tracking-wider">Las Huellitas de mi Vida</h1>
    </header>

    <main class="pt-24 pb-12 px-4">
        <!-- PASO 1.1: P√°gina Principal -->
        <section id="hero-section" class="text-center section-fade-in">
             <div class="flex justify-center mb-12">
                <img id="main-logo" src="https://i.ibb.co/0jRX3VX2/PORTADA-HUELLITAS-3.png" alt="Logo Las Huellitas de mi Vida" class="rounded-2xl max-w-sm md:max-w-md w-full shadow-2xl shadow-purple-900/50">
            </div>
            <h2 class="text-4xl md:text-5xl lg:text-6xl mb-6">Cada huella cuenta una historia üêæ</h2>
            <p class="max-w-2xl mx-auto mb-8 text-gray-300">Transformamos tus recuerdos m√°s preciados en una obra de arte √∫nica y emotiva.</p>
            <div class="flex justify-center mb-12">
                <img src="https://i.ibb.co/4R3Rx0Vx/Gemini_Generated_Image-b8hqcvb8hqcvb8hq.png" alt="Cuadro conmemorativo de mascota" class="rounded-2xl max-w-sm md:max-w-md w-full shadow-2xl shadow-purple-900/50">
            </div>
            <button id="start-project-btn" class="main-btn text-xl font-bold py-4 px-8 rounded-full">
                Elige tu Proyecto üêæ
            </button>
        </section>
        
        <!-- PASO 1.2: Selecci√≥n de Proyectos -->
        <section id="projects-section" class="mt-20 pt-10 text-center section-fade-in">
             <div class="relative max-w-max mx-auto mb-12">
                <h2 class="text-4xl md:text-5xl">¬øQu√© historia vamos a contar hoy? üêæ</h2>
                <img src="https://i.ibb.co/spPvfb9H/Dise-o-sin-t-tulo-6.png" alt="Cachorro decorativo" class="absolute -top-12 -right-32 md:-right-40 w-32 md:w-40 transform pointer-events-none opacity-90 hidden sm:block">
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-5xl mx-auto">
                <!-- Tarjeta 1: Homenaje -->
                <div class="category-card gradient-border-card p-8 rounded-2xl cursor-pointer" data-category="Homenaje a su Vida üêæ">
                    <div class="text-5xl mb-4">üïäÔ∏è</div>
                    <h3 class="text-2xl mb-2">Homenaje a su Vida</h3>
                    <p class="text-gray-400">Para conmemorar a un amigo fiel que cruz√≥ el arco√≠ris.</p>
                </div>
                <!-- Tarjeta 2: Celebraci√≥n -->
                <div class="category-card gradient-border-card p-8 rounded-2xl cursor-pointer" data-category="Celebrando su Vida üêæ">
                    <div class="text-5xl mb-4">üéâ</div>
                    <h3 class="text-2xl mb-2">Celebrando su Vida</h3>
                    <p class="text-gray-400">Para cumplea√±os, aniversarios de adopci√≥n y momentos especiales.</p>
                </div>
                <!-- Tarjeta 3: Camada -->
                <div class="category-card gradient-border-card p-8 rounded-2xl cursor-pointer" data-category="Celebrando la Nueva Familia üêæ">
                    <div class="text-5xl mb-4">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                    <h3 class="text-2xl mb-2">Nueva Familia</h3>
                    <p class="text-gray-400">Para dar la bienvenida a una adorable camada reci√©n llegada.</p>
                </div>
            </div>
        </section>

        <!-- PASO 1.3: Galer√≠a de Trabajos -->
        <section id="gallery-section" class="mt-20 section-fade-in">
             <h2 class="text-3xl md:text-4xl text-center mb-8">Nuestros dise√±os üêæ</h2>
             <div id="gallery-container" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                <!-- Las im√°genes de la galer√≠a se insertar√°n aqu√≠ por JS -->
             </div>
        </section>

        <!-- PASO 2: Formulario de Datos de la Mascota -->
        <section id="pet-data-section" class="hidden max-w-xl mx-auto text-center section-fade-in relative">
            <div id="decorative-pets-container">
                <img id="deco-homenaje" src="https://i.ibb.co/DfH4TPB8/Dise-o-sin-t-tulo-7.png" alt="Gato decorativo" class="decorative-pet-image absolute top-1/2 -translate-y-1/2 -left-24 md:-left-40 w-32 md:w-48 pointer-events-none opacity-90 hidden">
                <img id="deco-celebrando" src="https://i.ibb.co/rGXccYS2/Dise-o-sin-t-tulo-5.png" alt="Pato decorativo" class="decorative-pet-image absolute top-1/2 -translate-y-1/2 -left-24 md:-left-40 w-32 md:w-48 pointer-events-none opacity-90 hidden">
                <img id="deco-familia" src="https://i.ibb.co/7dRW4ZMY/Dise-o-sin-t-tulo-9.png" alt="Gato decorativo" class="decorative-pet-image absolute top-1/2 -translate-y-1/2 -left-24 md:-left-40 w-32 md:w-48 pointer-events-none opacity-90 hidden">
            </div>
            
            <h2 id="pet-data-title" class="text-4xl mb-10">Datos de tu Mascota</h2>
            <div class="space-y-8 text-left">
                <div>
                    <label for="pet-name" class="text-lg text-[#00FFFF]">Nombre de tu mascota</label>
                    <input type="text" id="pet-name" class="form-input w-full text-2xl p-2 mt-1">
                </div>
                <div>
                    <label for="pet-age" class="text-lg text-[#00FFFF]">Edad (en a√±os humanos)</label>
                    <input type="number" id="pet-age" min="0" class="form-input w-full text-2xl p-2 mt-1">
                </div>
            </div>
            <div class="flex justify-between mt-12">
                <button class="back-to-home-btn text-gray-400 hover:text-white transition-colors">‚Üê Volver al Inicio</button>
                <button id="continue-to-upload-btn" class="main-btn py-3 px-8 rounded-full font-bold">Continuar</button>
            </div>
        </section>

        <!-- PASO 3: Formulario de Carga de Archivos -->
        <section id="upload-section" class="hidden max-w-2xl mx-auto text-center section-fade-in">
            <h2 class="text-4xl mb-8">Ahora, sube tus recuerdos üêæ</h2>
            
            <div id="video-choice-container" class="space-y-4 mb-8">
                <p class="mb-4 text-lg">¬øIncluir√°s videos en tu homenaje?</p>
                <div class="flex justify-center space-x-4">
                    <button id="with-video-btn" class="main-btn py-3 px-6 rounded-lg">S√≠, tengo videos üêæ</button>
                    <button id="no-video-btn" class="bg-gray-700 hover:bg-gray-600 py-3 px-6 rounded-lg transition-colors">No, usar√© solo fotos üêæ</button>
                </div>
            </div>

            <!-- Contenedor principal del formulario de subida (oculto inicialmente) -->
            <div id="main-upload-form" class="hidden">
                <div class="text-right mb-4">
                    <button id="change-choice-btn" class="text-sm text-gray-400 hover:text-white transition-colors">‚Üê Cambiar elecci√≥n</button>
                </div>

                <!-- Contenedores de carga -->
                <div id="upload-containers" class="space-y-6 text-left mb-8">
                    <div id="photos-upload-container" class="bg-white/5 p-6 rounded-lg border-2 border-dashed border-gray-600">
                        <label id="photos-label" for="photos" class="text-lg text-[#00FFFF]">Sube tus fotos</label>
                        <p id="photos-description" class="text-sm text-gray-400 mb-2">Puedes seleccionar varios archivos.</p>
                        <input type="file" name="photos[]" id="photos" multiple accept="image/*" class="w-full">
                    </div>
                    <div id="video-upload-container" class="hidden bg-white/5 p-6 rounded-lg border-2 border-dashed border-gray-600">
                        <label for="video" class="text-lg text-[#00FFFF]">Sube tu video</label>
                        <p class="text-sm text-gray-400 mb-2">Recomendamos videos cortos.</p>
                        <input type="file" id="video" accept="video/*" class="w-full">
                    </div>
                </div>
                
                <!-- Campos de texto -->
                <div class="space-y-6 text-left mb-8">
                    <div>
                        <label for="short-text" class="text-lg text-[#00FFFF]">Texto Corto (para el cuadro)</label>
                        <div class="relative">
                            <input id="short-text" maxlength="150" class="form-input w-full text-xl p-2 mt-1 pr-16">
                            <span id="short-text-counter" class="absolute right-2 top-1/2 -translate-y-1/2 text-gray-400">0/150</span>
                        </div>
                    </div>
                    <div>
                        <label for="long-text" class="text-lg text-[#00FFFF]">Tu Historia (para inspirarnos)</label>
                        <div class="relative">
                            <textarea id="long-text" maxlength="400" rows="4" class="form-input w-full text-lg p-2 mt-1 pr-16"></textarea>
                            <span id="long-text-counter" class="absolute right-2 bottom-2 text-gray-400 transition-colors">0/400</span>
                        </div>
                    </div>
                </div>

                <!-- Checkbox Sorpr√©ndeme -->
                <div class="flex flex-col items-center justify-center mb-10">
                    <div class="flex items-center space-x-3">
                        <input type="checkbox" id="surprise-me" class="h-5 w-5 rounded accent-[#FF00FF]">
                        <label for="surprise-me" class="text-lg">¬°Sorpr√©ndeme! üêæ</label>
                    </div>
                    <p id="surprise-me-homenaje-text" class="text-yellow-400 text-base mt-2 hidden max-w-sm">
                        Al marcar esta opci√≥n, nuestro equipo elegir√° con mucho cari√±o un texto conmovedor y apropiado para la obra.
                    </p>
                </div>

                <div class="flex justify-between mt-12">
                    <button class="back-to-pet-data-btn text-gray-400 hover:text-white transition-colors">‚Üê Volver</button>
                    <button id="continue-to-summary-btn" class="main-btn py-3 px-8 rounded-full font-bold">Continuar al Resumen üêæ</button>
                </div>
            </div>
        </section>

        <!-- PASO 4: Resumen del Pedido -->
        <section id="summary-section" class="hidden max-w-5xl mx-auto text-center section-fade-in">
            <h2 class="text-4xl mb-6">Confirma tu Obra de Arte üêæ</h2>
            <div class="mb-12 text-center italic">
                <p class="text-2xl text-yellow-400">"La pintura es poes√≠a que se ve en lugar de sentirse, y la poes√≠a es pintura que se siente en lugar de verse."</p>
                <p class="text-base text-gray-400 mt-2">- Leonardo da Vinci</p>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
                <div class="text-left space-y-6 bg-white/5 p-8 rounded-2xl border border-white/10 h-full">
                    <h3 class="text-3xl font-bold text-white">Tu Cuadro Conmemorativo</h3>
                    <p class="text-gray-300">Con la informaci√≥n, fotos y videos que nos brindas, creamos de manera respetuosa una bella recopilaci√≥n de los recuerdos que vivieron juntos. Esta obra servir√° para recordar y homenajear siempre a tu mascota, sin importar qu√© animalito sea.</p>
                    <div>
                        <h4 class="text-xl font-bold text-[#00FFFF]">Especificaciones:</h4>
                        <ul class="list-disc list-inside text-gray-300 mt-2 space-y-1">
                            <li>Tama√±o del cuadro: 60 x 50 cm.</li>
                            <li>Terminaciones en vidrio opaco.</li>
                            <li>Impresi√≥n en papel fotogr√°fico Matte de alta calidad.</li>
                            <li>Ilustraci√≥n dibujada y pintada a mano en base a tus im√°genes para captar la personalidad √∫nica de tu amiguito(a).</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="text-xl font-bold text-[#00FFFF]">Tiempos de Entrega:</h4>
                        <ul class="list-disc list-inside text-gray-300 mt-2 space-y-1">
                            <li><span class="font-bold">Rancagua:</span> 72 horas.</li>
                            <li><span class="font-bold">Otras Regiones:</span> 5 d√≠as h√°biles.</li>
                        </ul>
                    </div>
                </div>
                <div class="space-y-8">
                    <div class="bg-white/5 p-8 rounded-2xl text-left space-y-4 border border-white/10">
                         <h3 class="text-2xl font-bold text-center mb-4">Detalles de tu Proyecto</h3>
                        <div>
                            <p class="text-lg text-[#00FFFF] opacity-80">Categor√≠a:</p>
                            <p id="summary-category" class="text-2xl font-bold"></p>
                        </div>
                        <hr class="border-white/10">
                        <div>
                            <p class="text-lg text-[#00FFFF] opacity-80">Nombre de la Mascota:</p>
                            <p id="summary-pet-name" class="text-2xl font-bold"></p>
                        </div>
                        <hr class="border-white/10">
                        <div>
                            <p class="text-lg text-[#00FFFF] opacity-80">Edad:</p>
                            <p id="summary-pet-age" class="text-2xl font-bold"></p>
                        </div>
                    </div>
                    <div id="summary-images-container" class="grid grid-cols-2 gap-4">
                        <!-- Las im√°genes subidas por el usuario se mostrar√°n aqu√≠ -->
                    </div>
                </div>
            </div>
            <div class="flex justify-between mt-16 max-w-2xl mx-auto">
                <button class="back-to-upload-btn text-gray-400 hover:text-white transition-colors">‚Üê Volver y Editar</button>
                <button id="continue-to-payment-btn" class="main-btn py-4 px-10 rounded-full font-bold text-lg">Continuar al Pago üêæ</button>
            </div>
        </section>

        <!-- PASO 5: Env√≠o y Pago -->
        <section id="payment-section" class="hidden max-w-5xl mx-auto section-fade-in">
            <h2 class="text-4xl mb-8 text-center">Detalles de Env√≠o y Pago üêæ</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                <!-- Columna Izquierda: Despacho y Resumen -->
                <div class="bg-white/5 p-8 rounded-2xl border border-white/10 space-y-8">
                    <div>
                        <h3 class="text-2xl mb-6 font-bold">1. Direcci√≥n de Despacho</h3>
                        <form id="shipping-form" class="space-y-6">
                            <div>
                                <label for="full-name" class="text-lg text-[#00FFFF]">Nombre Completo</label>
                                <input type="text" id="full-name" class="form-input w-full p-2 mt-1" required>
                            </div>
                            <div>
                                <label for="address" class="text-lg text-[#00FFFF]">Direcci√≥n</label>
                                <input type="text" id="address" class="form-input w-full p-2 mt-1" required>
                            </div>
                            <div>
                                <label for="city" class="text-lg text-[#00FFFF]">Comuna / Ciudad</label>
                                <input type="text" id="city" class="form-input w-full p-2 mt-1" required>
                            </div>
                            <div>
                                <label for="phone" class="text-lg text-[#00FFFF]">Tel√©fono de Contacto</label>
                                <input type="tel" id="phone" class="form-input w-full p-2 mt-1" required>
                            </div>
                        </form>
                    </div>
                     <div>
                        <h3 class="text-2xl mb-6 font-bold">2. Resumen de Compra</h3>
                        <div class="space-y-4">
                            <div>
                                <label for="shipping-zone" class="text-lg text-[#00FFFF]">Selecciona tu zona de env√≠o:</label>
                                <select id="shipping-zone" class="form-input w-full p-2 mt-1 bg-[#2b1634]">
                                    <option value="centro">Rancagua Centro (Env√≠o Gratis)</option>
                                    <option value="alrededores">Alrededores de Rancagua</option>
                                    <option value="regiones">Otras Regiones</option>
                                </select>
                            </div>
                            <div class="mt-4">
                                <label for="coupon-code" class="text-lg text-[#00FFFF]">¬øTienes un cup√≥n de descuento?</label>
                                <div class="flex gap-2 mt-1">
                                    <input type="text" id="coupon-code" placeholder="Ej: HUELLITAS-A1B2C3" class="form-input w-full p-2 bg-[#2b1634]">
                                    <button id="apply-coupon-btn" class="bg-gray-700 hover:bg-gray-600 px-4 rounded-lg text-sm font-bold transition-colors">Aplicar</button>
                                </div>
                            </div>
                            <hr class="border-white/10 my-4">
                            <div class="flex justify-between text-lg">
                                <span>Precio del Cuadro:</span>
                                <span id="subtotal-price"></span>
                            </div>
                             <div id="discount-row" class="hidden flex justify-between text-lg text-green-400">
                                <span>Descuento (15%):</span>
                                <span id="discount-amount"></span>
                            </div>
                            <div class="flex justify-between text-lg">
                                <span>Costo de Env√≠o:</span>
                                <span id="shipping-cost"></span>
                            </div>
                            <hr class="border-dashed border-white/20 my-4">
                            <div class="flex justify-between text-3xl font-bold">
                                <span>TOTAL:</span>
                                <span id="total-price"></span>
                            </div>
                        </div>
                    </div>
                </div>
                 <!-- Columna Derecha: M√©todo de Pago -->
                <div class="bg-white/5 p-8 rounded-2xl border border-white/10">
                    <h3 class="text-2xl mb-6 font-bold">3. Realiza tu Pago</h3>
                    
                    <!-- Datos de Transferencia -->
                    <div id="transfer-payment-details" class="space-y-2 text-center content-fade-in bg-white/5 p-6 rounded-lg">
                        <h4 class="text-lg font-bold">Datos para Transferir</h4>
                        <p><strong>Banco:</strong> <span data-key="banco"></span></p>
                        <p><strong>Tipo de Cuenta:</strong> <span data-key="tipoCuenta"></span></p>
                        <p><strong>N√∫mero:</strong> <span data-key="numero"></span></p>
                        <p><strong>Nombre:</strong> <span data-key="nombre"></span></p>
                        <p><strong>RUT:</strong> <span data-key="rut"></span></p>
                        <p><strong>Email:</strong> <span data-key="email"></span></p>
                        <p class="text-sm text-yellow-400 mt-4">Una vez realizada la transferencia, env√≠a el comprobante a nuestro WhatsApp para confirmar tu pedido.</p>
                    </div>
                    
                    <div class="flex justify-between mt-12">
                        <button class="back-to-summary-btn text-gray-400 hover:text-white transition-colors">‚Üê Volver</button>
                        <button id="finish-purchase-btn" class="main-btn py-4 px-10 rounded-full font-bold text-lg">Enviar Comprobante por WhatsApp üêæ</button>
                    </div>
                </div>
            </div>
        </section>

    </main>
    
    <!-- Panel de Administrador -->
    <div id="admin-panel" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-[100] overflow-y-auto p-4">
        <div class="bg-[#2b1634] p-8 rounded-lg shadow-2xl border-2 border-[#4A00E0] w-full max-w-md space-y-8">
             <div class="relative text-center">
                 <h3 class="text-2xl">Panel de Administrador üêæ</h3>
                 <button id="close-admin-btn" class="absolute -top-4 -right-4 text-3xl text-white">&times;</button>
            </div>

            <!-- Secci√≥n de Galer√≠a -->
            <div class="space-y-4">
                <h4 class="text-xl font-bold text-center">Gestionar Galer√≠a</h4>
                <input id="gallery-url-input" type="text" placeholder="URL de la nueva imagen" class="form-input w-full text-center">
                <button id="add-image-btn" class="w-full main-btn py-2 px-6 rounded-lg">Agregar Imagen</button>
            </div>
            
            <hr class="border-white/20">

            <!-- Secci√≥n de Datos Bancarios -->
            <div class="space-y-4">
                <h4 class="text-xl font-bold text-center">Editar Datos Bancarios</h4>
                <div class="space-y-2 text-left">
                    <label class="text-sm text-[#00FFFF]">Banco</label>
                    <input id="admin-banco" type="text" class="form-input w-full">
                    <label class="text-sm text-[#00FFFF]">Tipo de Cuenta</label>
                    <input id="admin-tipo-cuenta" type="text" class="form-input w-full">
                    <label class="text-sm text-[#00FFFF]">N√∫mero</label>
                    <input id="admin-numero" type="text" class="form-input w-full">
                    <label class="text-sm text-[#00FFFF]">Nombre</label>
                    <input id="admin-nombre" type="text" class="form-input w-full">
                    <label class="text-sm text-[#00FFFF]">RUT</label>
                    <input id="admin-rut" type="text" class="form-input w-full">
                    <label class="text-sm text-[#00FFFF]">Email de Contacto</label>
                    <input id="admin-email" type="text" class="form-input w-full">
                </div>
                <button id="save-bank-details-btn" class="w-full main-btn py-2 px-6 rounded-lg">Guardar Datos</button>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="message-modal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-[101]">
        <div class="bg-[#2b1634] p-8 rounded-lg shadow-2xl text-center border-2 border-[#4A00E0] w-full max-w-sm">
            <h3 id="message-title" class="text-2xl mb-4">Mensaje</h3>
            <p id="message-text" class="text-gray-300 mb-6">Contenido del mensaje.</p>
            <button id="message-close-btn" class="main-btn py-2 px-8 rounded-lg">Cerrar</button>
        </div>
    </div>

    <div id="password-modal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-[101]">
        <div class="bg-[#2b1634] p-8 rounded-lg shadow-2xl text-center border-2 border-[#4A00E0] w-full max-w-sm">
            <h3 class="text-2xl mb-4">Acceso de Administrador</h3>
            <p class="text-gray-300 mb-4">Por favor, ingrese la contrase√±a:</p>
            <input id="password-input" type="password" class="form-input w-full text-center mb-2">
            <p id="password-error" class="text-red-500 text-sm h-4 mb-2"></p>
            <div class="flex gap-4">
                <button id="password-cancel-btn" class="bg-gray-700 hover:bg-gray-600 flex-1 py-2 px-6 rounded-lg transition-colors">Cancelar</button>
                <button id="password-submit-btn" class="main-btn flex-1 py-2 px-6 rounded-lg">Ingresar</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        document.addEventListener('DOMContentLoaded', () => {
            
            const firebaseConfig = {
              apiKey: "AIzaSyCA-WP1HvNPu-Oh6wOCjGPseyvxa7PMlPA",
              authDomain: "huellitas-web-9108f.firebaseapp.com",
              projectId: "huellitas-web-9108f",
              storageBucket: "huellitas-web-9108f.appspot.com",
              messagingSenderId: "1098590067913",
              appId: "1:1098590067913:web:db7862baddcfb45f8f8118"
            };
            
             const displays = {
                messageModal: document.getElementById('message-modal'),
                messageTitle: document.getElementById('message-title'),
                messageText: document.getElementById('message-text'),
                passwordModal: document.getElementById('password-modal'),
                passwordError: document.getElementById('password-error'),
                mainLogo: document.getElementById('main-logo'),
            };
             const buttons = {
                messageClose: document.getElementById('message-close-btn'),
                passwordSubmit: document.getElementById('password-submit-btn'),
                passwordCancel: document.getElementById('password-cancel-btn'),
             };
             const inputs = { password: document.getElementById('password-input') };

            function showMessage(title, message) {
                displays.messageTitle.textContent = title;
                displays.messageText.textContent = message;
                displays.messageModal.classList.remove('hidden');
            }
            buttons.messageClose.addEventListener('click', () => displays.messageModal.classList.add('hidden'));

            let isAdmin = false;

            const adminPassword = 'huellitas_admin';
                
            function showAdminLogin() {
                inputs.password.value = '';
                displays.passwordError.textContent = '';
                displays.passwordModal.classList.remove('hidden');
            }

            buttons.passwordCancel.addEventListener('click', () => {
                displays.passwordModal.classList.add('hidden');
            });

            buttons.passwordSubmit.addEventListener('click', () => {
                if (inputs.password.value === adminPassword) {
                    displays.passwordModal.classList.add('hidden');
                    isAdmin = true;
                    document.getElementById('admin-panel').classList.remove('hidden');
                    document.dispatchEvent(new Event('adminLoginSuccess'));
                } else {
                    displays.passwordError.textContent = 'Contrase√±a incorrecta.';
                }
            });
            
            const konamiCode = ['arrowup', 'arrowup', 'arrowdown', 'arrowdown', 'arrowleft', 'arrowright', 'arrowleft', 'arrowright', 'b', 'a'];
            let konamiPosition = 0;
            document.addEventListener('keyup', (e) => {
                if (isAdmin) return;
                if (e.key.toLowerCase() === konamiCode[konamiPosition]) {
                    konamiPosition++;
                    if (konamiPosition === konamiCode.length) {
                        konamiPosition = 0;
                        showAdminLogin();
                    }
                } else if (!e.target.matches('input, textarea')) {
                    konamiPosition = 0;
                }
            });

            let tapCount = 0;
            let tapTimer;
            displays.mainLogo.addEventListener('click', () => {
                if (isAdmin) return;
                tapCount++;
                clearTimeout(tapTimer);
                if (tapCount >= 7) {
                    tapCount = 0;
                    showAdminLogin();
                } else {
                    tapTimer = setTimeout(() => { tapCount = 0; }, 1500);
                }
            });


            if (!firebaseConfig.projectId) {
                console.error("Configuraci√≥n de Firebase no encontrada.");
                showMessage("Error de Configuraci√≥n", "No se encontraron las claves de Firebase. La aplicaci√≥n no podr√° guardar datos en la nube.");
            } else {
                initializeAppLogic();
            }

            function initializeAppLogic() {
                const app = initializeApp(firebaseConfig);
                const db = getFirestore(app);

                const galleryDocRef = doc(db, "content", "gallery");
                const bankDetailsDocRef = doc(db, "content", "bankDetails");

                let isCouponApplied = false;
                let discountAmount = 0;
                const userSelection = { category: null, petName: null, petAge: null };
                let bankDetails = {};
                let galleryImages = [];

                const sections = {
                    hero: document.getElementById('hero-section'),
                    gallery: document.getElementById('gallery-section'),
                    projects: document.getElementById('projects-section'),
                    petData: document.getElementById('pet-data-section'),
                    upload: document.getElementById('upload-section'),
                    summary: document.getElementById('summary-section'),
                    payment: document.getElementById('payment-section'),
                };

                const allButtons = {
                    ...buttons,
                    startProject: document.getElementById('start-project-btn'),
                    categoryCards: document.querySelectorAll('.category-card'),
                    backToHome: document.querySelector('.back-to-home-btn'),
                    continueToUpload: document.getElementById('continue-to-upload-btn'),
                    backToPetData: document.querySelector('.back-to-pet-data-btn'),
                    continueToSummary: document.getElementById('continue-to-summary-btn'),
                    backToUpload: document.querySelector('.back-to-upload-btn'),
                    continueToPayment: document.getElementById('continue-to-payment-btn'),
                    backToSummary: document.querySelectorAll('.back-to-summary-btn'),
                    finishPurchase: document.getElementById('finish-purchase-btn'),
                    withVideo: document.getElementById('with-video-btn'),
                    noVideo: document.getElementById('no-video-btn'),
                    changeChoice: document.getElementById('change-choice-btn'),
                    applyCoupon: document.getElementById('apply-coupon-btn'),
                    addImage: document.getElementById('add-image-btn'),
                    saveBankDetails: document.getElementById('save-bank-details-btn'),
                    closeAdmin: document.getElementById('close-admin-btn'),
                };

                const allInputs = {
                    ...inputs,
                    petName: document.getElementById('pet-name'),
                    petAge: document.getElementById('pet-age'),
                    shortText: document.getElementById('short-text'),
                    longText: document.getElementById('long-text'),
                    surpriseMe: document.getElementById('surprise-me'),
                    galleryUrl: document.getElementById('gallery-url-input'),
                    photos: document.getElementById('photos'),
                    couponCode: document.getElementById('coupon-code'),
                    shippingZone: document.getElementById('shipping-zone'),
                    shippingFullName: document.getElementById('full-name'),
                    shippingAddress: document.getElementById('address'),
                    shippingCity: document.getElementById('city'),
                    shippingPhone: document.getElementById('phone'),
                    adminBanco: document.getElementById('admin-banco'),
                    adminTipoCuenta: document.getElementById('admin-tipo-cuenta'),
                    adminNumero: document.getElementById('admin-numero'),
                    adminNombre: document.getElementById('admin-nombre'),
                    adminRut: document.getElementById('admin-rut'),
                    adminEmail: document.getElementById('admin-email'),
                };

                const allDisplays = {
                    ...displays,
                    petDataTitle: document.getElementById('pet-data-title'),
                    videoChoiceContainer: document.getElementById('video-choice-container'),
                    mainUploadForm: document.getElementById('main-upload-form'),
                    uploadContainers: document.getElementById('upload-containers'),
                    photosContainer: document.getElementById('photos-upload-container'),
                    videoContainer: document.getElementById('video-upload-container'),
                    photosLabel: document.getElementById('photos-label'),
                    photosDescription: document.getElementById('photos-description'),
                    shortTextCounter: document.getElementById('short-text-counter'),
                    longTextCounter: document.getElementById('long-text-counter'),
                    galleryContainer: document.getElementById('gallery-container'),
                    surpriseMeText: document.getElementById('surprise-me-homenaje-text'),
                    summaryCategory: document.getElementById('summary-category'),
                    summaryPetName: document.getElementById('summary-pet-name'),
                    summaryPetAge: document.getElementById('summary-pet-age'),
                    summaryImagesContainer: document.getElementById('summary-images-container'),
                    subtotalPrice: document.getElementById('subtotal-price'),
                    shippingCost: document.getElementById('shipping-cost'),
                    discountRow: document.getElementById('discount-row'),
                    discountAmount: document.getElementById('discount-amount'),
                    totalPrice: document.getElementById('total-price'),
                };
                
                const decorativeImages = document.querySelectorAll('.decorative-pet-image');
                
                onSnapshot(galleryDocRef, (doc) => {
                    if (doc.exists()) {
                        galleryImages = doc.data().images || [];
                        renderGallery();
                    }
                });

                onSnapshot(bankDetailsDocRef, (doc) => {
                    if (doc.exists()) {
                        bankDetails = doc.data();
                        renderBankDetails();
                    }
                });

                function renderBankDetails() {
                    if (bankDetails) {
                        document.querySelectorAll('#transfer-payment-details [data-key]').forEach(span => {
                            span.textContent = bankDetails[span.dataset.key] || '';
                        });
                    }
                }
                
                function renderGallery() {
                    allDisplays.galleryContainer.innerHTML = '';
                    galleryImages.forEach(img => {
                        const deleteButtonHTML = isAdmin ? `<div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"><button data-id="${img.id}" class="delete-image-btn text-white bg-red-600/80 rounded-full w-10 h-10 font-bold">X</button></div>` : '';
                        allDisplays.galleryContainer.innerHTML += `<div class="relative group overflow-hidden rounded-lg"><img src="${img.url}" alt="${img.alt}" class="w-full h-full object-cover aspect-square transition-transform duration-300 group-hover:scale-110">${deleteButtonHTML}</div>`;
                    });
                }

                document.addEventListener('adminLoginSuccess', renderGallery);

                function goToFormSection(targetSection) {
                    Object.values(sections).forEach(s => s.classList.add('hidden'));
                    targetSection.classList.remove('hidden');
                    window.scrollTo(0, 0);
                }

                function showHomePage() {
                    Object.values(sections).forEach(s => s.classList.add('hidden'));
                    sections.hero.classList.remove('hidden');
                    sections.projects.classList.remove('hidden');
                    sections.gallery.classList.remove('hidden');
                    window.scrollTo(0, 0);
                }

                allButtons.startProject.addEventListener('click', () => {
                    document.getElementById('projects-section').scrollIntoView();
                });

                allButtons.categoryCards.forEach(card => {
                    card.addEventListener('click', () => {
                        userSelection.category = card.dataset.category;
                        allDisplays.petDataTitle.textContent = `Proyecto: ${userSelection.category}`;
                        decorativeImages.forEach(img => img.classList.add('hidden'));
                        if (userSelection.category.includes('Homenaje')) document.getElementById('deco-homenaje').classList.remove('hidden');
                        else if (userSelection.category.includes('Celebrando su Vida')) document.getElementById('deco-celebrando').classList.remove('hidden');
                        else if (userSelection.category.includes('Nueva Familia')) document.getElementById('deco-familia').classList.remove('hidden');
                        goToFormSection(sections.petData);
                    });
                });

                allButtons.backToHome.addEventListener('click', () => showHomePage());
                
                allButtons.continueToUpload.addEventListener('click', () => {
                    if (allInputs.petName.value.trim() === '' || allInputs.petAge.value === '') {
                        showMessage('Campos Incompletos', 'Por favor, completa todos los campos para continuar.');
                        return;
                    }
                    userSelection.petName = allInputs.petName.value;
                    userSelection.petAge = allInputs.petAge.value;
                    allDisplays.surpriseMeText.classList.toggle('hidden', !userSelection.category.includes('Homenaje'));
                    goToFormSection(sections.upload);
                });
                
                allButtons.backToPetData.addEventListener('click', () => goToFormSection(sections.petData));
                
                allButtons.continueToSummary.addEventListener('click', () => {
                    allDisplays.summaryCategory.textContent = userSelection.category;
                    allDisplays.summaryPetName.textContent = userSelection.petName;
                    allDisplays.summaryPetAge.textContent = `${userSelection.petAge} a√±os`;
                    allDisplays.summaryImagesContainer.innerHTML = '';
                    const imagesToShow = galleryImages.slice(0, 2);
                    if(imagesToShow.length > 0) {
                        imagesToShow.forEach(galleryImage => {
                            allDisplays.summaryImagesContainer.innerHTML += `<img src="${galleryImage.url}" alt="${galleryImage.alt}" class="rounded-lg w-full aspect-square object-cover">`;
                        });
                    } else {
                        allDisplays.summaryImagesContainer.innerHTML = `<div class="rounded-lg w-full aspect-square bg-white/10 flex items-center justify-center"><p class="text-gray-400">Ejemplo 1</p></div><div class="rounded-lg w-full aspect-square bg-white/10 flex items-center justify-center"><p class="text-gray-400">Ejemplo 2</p></div>`;
                    }
                    goToFormSection(sections.summary);
                });

                allButtons.backToUpload.addEventListener('click', () => goToFormSection(sections.upload));
                
                allButtons.continueToPayment.addEventListener('click', () => {
                    updatePaymentSummary();
                    goToFormSection(sections.payment);
                });
                
                document.querySelectorAll('.back-to-summary-btn').forEach(btn => {
                    btn.addEventListener('click', () => goToFormSection(sections.summary));
                });

                allButtons.finishPurchase.addEventListener('click', () => {
                    const shippingForm = document.getElementById('shipping-form');
                    if (!shippingForm.checkValidity()) {
                        showMessage('Datos Faltantes', 'Por favor, completa todos los campos de la direcci√≥n de despacho.');
                        return;
                    }
                    
                    const googleSheetScriptUrl = 'https://script.google.com/macros/s/AKfycbx5Rv_MV-2bd8rxP9ly6Tju9CIUGXjpE8aPKYTs8lSgEd_y0mA191L1OLmnUC_6lCz2/exec';
                    const selectedZone = allInputs.shippingZone.value;
                    const shippingCost = SHIPPING_COSTS[selectedZone];
                    const total = PRODUCT_PRICE + shippingCost - discountAmount;

                    const orderData = {
                        categoria: userSelection.category,
                        nombreMascota: userSelection.petName,
                        edadMascota: userSelection.petAge,
                        nombreCliente: allInputs.shippingFullName.value,
                        direccion: allInputs.shippingAddress.value,
                        comuna: allInputs.shippingCity.value,
                        telefono: allInputs.shippingPhone.value,
                        costoEnvio: shippingCost,
                        totalPagado: total
                    };

                    const purchaseButton = allButtons.finishPurchase;
                    purchaseButton.disabled = true;
                    purchaseButton.innerHTML = 'Procesando...';

                    if(googleSheetScriptUrl && googleSheetScriptUrl !== 'https://script.google.com/macros/s/AKfycbx5Rv_MV-2bd8rxP9ly6Tju9CIUGXjpE8aPKYTs8lSgEd_y0mA191L1OLmnUC_6lCz2/exec') {
                        fetch(googleSheetScriptUrl, {
                            method: 'POST',
                            body: JSON.stringify(orderData)
                        })
                        .then(response => response.json())
                        .then(data => {
                            console.log('Success:', data);
                            openWhatsApp();
                        })
                        .catch((error) => {
                            console.error('Error:', error);
                            showMessage('Error', 'Hubo un error al registrar tu pedido. Por favor, intenta de nuevo.');
                        })
                        .finally(() => {
                            purchaseButton.disabled = false;
                            purchaseButton.innerHTML = 'Enviar Comprobante por WhatsApp üêæ';
                        });
                    } else {
                        console.log('URL de Google Sheet no configurada. Abriendo WhatsApp directamente.');
                        openWhatsApp();
                        purchaseButton.disabled = false;
                        purchaseButton.innerHTML = 'Enviar Comprobante por WhatsApp üêæ';
                    }
                });

                function openWhatsApp() {
                    const whatsappPhoneNumber = '56946902340';
                    const message = encodeURIComponent('¬°Hola! Te contacto desde "Las Huellitas de mi Vida" para enviar mi comprobante de pago. üêæ');
                    window.open(`https://api.whatsapp.com/send?phone=${whatsappPhoneNumber}&text=${message}`, '_blank');
                }

                allInputs.photos.addEventListener('change', (event) => {
                    const photoContainer = document.getElementById('photos-upload-container');
                    let fileCountDisplay = photoContainer.querySelector('.file-count-display');
                    if (!fileCountDisplay) {
                        fileCountDisplay = document.createElement('p');
                        fileCountDisplay.className = 'file-count-display text-sm text-green-400 mt-2';
                        photoContainer.appendChild(fileCountDisplay);
                    }
                    if (event.target.files.length > 0) {
                        fileCountDisplay.textContent = `${event.target.files.length} archivo(s) seleccionado(s) con √©xito.`;
                    } else {
                        fileCountDisplay.textContent = '';
                    }
                });

                function showUploadForm(withVideo) {
                    allDisplays.videoChoiceContainer.classList.add('hidden');
                    allDisplays.mainUploadForm.classList.remove('hidden');
                    if (withVideo) {
                        allDisplays.videoContainer.classList.remove('hidden');
                        allDisplays.photosDescription.textContent = "Puedes subir hasta 10 fotos.";
                    } else {
                        allDisplays.videoContainer.classList.add('hidden');
                        allDisplays.photosDescription.textContent = "Puedes subir hasta 20 fotos. Crearemos un video emotivo a partir de ellas.";
                    }
                }

                allButtons.withVideo.addEventListener('click', () => showUploadForm(true));
                allButtons.noVideo.addEventListener('click', () => showUploadForm(false));
                allButtons.changeChoice.addEventListener('click', () => {
                    allDisplays.mainUploadForm.classList.add('hidden');
                    allDisplays.videoChoiceContainer.classList.remove('hidden');
                });
                
                function updatePaymentSummary() {
                    const selectedZone = allInputs.shippingZone.value;
                    const shippingCost = SHIPPING_COSTS[selectedZone];
                    let total = PRODUCT_PRICE + shippingCost;
                    if (isCouponApplied) {
                        total -= discountAmount;
                    }
                    allDisplays.subtotalPrice.textContent = formatPrice(PRODUCT_PRICE);
                    allDisplays.shippingCost.textContent = formatPrice(shippingCost);
                    allDisplays.totalPrice.textContent = formatPrice(total);
                }
                
                allInputs.shippingZone.addEventListener('change', updatePaymentSummary);

                allButtons.applyCoupon.addEventListener('click', () => {
                    const code = allInputs.couponCode.value.trim().toUpperCase();
                    if (isCouponApplied) {
                        showMessage('Aviso', 'Ya se ha aplicado un descuento en esta compra.');
                        return;
                    }
                    if (code.includes('HUELLITAS')) {
                        isCouponApplied = true;
                        discountAmount = PRODUCT_PRICE * 0.15;
                        allDisplays.discountAmount.textContent = `- ${formatPrice(discountAmount)}`;
                        allDisplays.discountRow.classList.remove('hidden');
                        updatePaymentSummary();
                        showMessage('¬°√âxito!', 'Cup√≥n del 15% aplicado con √©xito.');
                        allInputs.couponCode.disabled = true;
                        allButtons.applyCoupon.disabled = true;
                        allButtons.applyCoupon.textContent = 'Aplicado';
                    } else {
                        showMessage('Error', 'El c√≥digo del cup√≥n no es v√°lido.');
                    }
                });

                function setupCounter(inputElement, counterElement, maxLength) {
                    inputElement.addEventListener('input', () => {
                        const currentLength = inputElement.value.length;
                        counterElement.textContent = `${currentLength}/${maxLength}`;
                        counterElement.classList.toggle('text-red-500', currentLength > maxLength);
                    });
                }
                setupCounter(allInputs.shortText, allDisplays.shortTextCounter, 150);
                setupCounter(allInputs.longText, allDisplays.longTextCounter, 400);

                allInputs.surpriseMe.addEventListener('change', (e) => {
                    const isChecked = e.target.checked;
                    allInputs.shortText.disabled = isChecked;
                    allInputs.longText.disabled = isChecked;
                    if (isChecked) {
                        allInputs.shortText.value = '';
                        allInputs.longText.value = '';
                        allInputs.shortText.dispatchEvent(new Event('input'));
                        allInputs.longText.dispatchEvent(new Event('input'));
                    }
                });

                async function updateGalleryInFirebase() {
                    try {
                        await setDoc(galleryDocRef, { images: galleryImages });
                        console.log("Gallery updated in Firebase");
                    } catch (e) {
                        console.error("Error updating gallery: ", e);
                    }
                }

                allButtons.addImage.addEventListener('click', () => {
                    const url = allInputs.galleryUrl.value.trim();
                    if (url) {
                        galleryImages.unshift({ id: Date.now(), url: url, alt: 'Nueva imagen de mascota' });
                        updateGalleryInFirebase();
                        allInputs.galleryUrl.value = '';
                    }
                });

                allDisplays.galleryContainer.addEventListener('click', (e) => {
                    if (e.target.classList.contains('delete-image-btn')) {
                        const idToDelete = parseInt(e.target.dataset.id);
                        galleryImages = galleryImages.filter(img => img.id !== idToDelete);
                        updateGalleryInFirebase();
                    }
                });
                
                allButtons.closeAdmin.addEventListener('click', () => {
                    document.getElementById('admin-panel').classList.add('hidden');
                    isAdmin = false;
                    renderGallery();
                });

                allButtons.saveBankDetails.addEventListener('click', async () => {
                    const newBankDetails = {
                        banco: allInputs.adminBanco.value,
                        tipoCuenta: allInputs.adminTipoCuenta.value,
                        numero: allInputs.adminNumero.value,
                        nombre: allInputs.adminNombre.value,
                        rut: allInputs.adminRut.value,
                        email: allInputs.adminEmail.value,
                    };
                    try {
                        await setDoc(bankDetailsDocRef, newBankDetails);
                        showMessage('¬°Guardado!', '¬°Datos bancarios guardados con √©xito!');
                    } catch(e) {
                        console.error("Error saving bank details: ", e);
                        showMessage('Error', 'No se pudieron guardar los datos. Intenta de nuevo.');
                    }
                });

                document.addEventListener('adminLoginSuccess', renderGallery);
            }
        });
    </script>
</body>
</html>


